<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>javascript/json_emp.html</title>
</head>
<body>
    <script>
    let rawData = `[{"id":1,"first_name":"Shirleen","last_name":"Novik","email":"snovik0@theguardian.com","gender":"Male","ip_address":"195.72.15.222"},
    {"id":2,"first_name":"Anastassia","last_name":"Heap","email":"aheap1@reddit.com","gender":"Female","ip_address":"249.5.56.110"},
    {"id":3,"first_name":"Standford","last_name":"Luckcuck","email":"sluckcuck2@slate.com","gender":"Female","ip_address":"119.116.101.203"},
    {"id":4,"first_name":"Padgett","last_name":"Douse","email":"pdouse3@abc.net.au","gender":"Female","ip_address":"244.172.199.147"},
    {"id":5,"first_name":"Dulce","last_name":"Cranham","email":"dcranham4@360.cn","gender":"Agender","ip_address":"155.43.212.37"},
    {"id":6,"first_name":"Charmion","last_name":"Gresham","email":"cgresham5@deviantart.com","gender":"Bigender","ip_address":"9.244.68.30"},
    {"id":7,"first_name":"Robbert","last_name":"Paroni","email":"rparoni6@dropbox.com","gender":"Female","ip_address":"203.241.155.141"},
    {"id":8,"first_name":"Katy","last_name":"Reubbens","email":"kreubbens7@1688.com","gender":"Agender","ip_address":"23.199.152.58"},
    {"id":9,"first_name":"Gradey","last_name":"Larcher","email":"glarcher8@youtu.be","gender":"Bigender","ip_address":"97.29.249.9"},
    {"id":10,"first_name":"Marv","last_name":"Ireland","email":"mireland9@gmpg.org","gender":"Polygender","ip_address":"247.115.159.42"},
    {"id":11,"first_name":"Wallis","last_name":"Thurston","email":"wthurstona@simplemachines.org","gender":"Polygender","ip_address":"155.135.106.240"},
    {"id":12,"first_name":"Alexandrina","last_name":"Piaggia","email":"apiaggiab@google.fr","gender":"Polygender","ip_address":"141.60.16.215"},
    {"id":13,"first_name":"Michaella","last_name":"Aupol","email":"maupolc@home.pl","gender":"Non-binary","ip_address":"84.203.107.107"},
    {"id":14,"first_name":"Sutton","last_name":"Keddie","email":"skeddied@theguardian.com","gender":"Male","ip_address":"235.173.158.217"},
    {"id":15,"first_name":"Marcel","last_name":"Glas","email":"mglase@cyberchimps.com","gender":"Agender","ip_address":"186.42.87.156"}]` ;

    let data = JSON.parse(rawData) ;
    
    function clickFnc(e) {                                           // 버튼 클릭했을 때 function 생성
        let btn = e.target ;                                         // 이벤트의 타겟을 btn에 입력
        btn.parentNode.parentNode.remove() ;                         // 버튼이 td 안에 들어있고 td는 tr안에 들어있기 때문에
    }                                                                // 버튼의 부모 = td , td의 부모 tr / 한줄씩 삭제하기 위해서는 부모의 부모 객체를 삭제 해줘야함
                                                                     // parentNode 한번만 쓰면 td , 즉 테이블의 버튼이 들어있는 칸 만 삭제함
    document.write("<table border=1>") ;                             // 테이블 생성
    document.write("<thead><tr><th colspan='7'>list</th></th>") ;  
    let key = Object.keys(data[0]) ;                                 // 오브젝트에서 키값을 불러오는 코드 Object.keys.오브젝트명 
    document.write("<tr></tr>") ;                                    // 어차피 data 오브젝트 안에서 key값은 0번이나 1번이나 2번이나 같기 때문에 0번에꺼 한번만 불러와서 key에 담음
    for (let i = 0 ; i < key.length ; i++) {                         // key값이 6개라 6번 반복하면서 각각의 키값을 td에 넣어서 제목줄을 만듦
        document.write("<td>" + key[i] + "</td>") ;
    }
    document.write("<td>button</td>") ;                              // 버튼 들어갈 칸 제목 생성
    document.write("<tr></tr>") ;
    for (let field of data) {                                        // 배열 순환으로 배열의 값(id:1 , first_name:shirleen...)을 field에 넣고
        document.write("<tr></tr>") ;
        for (let d in field) {                                       // 객체 순환으로 field의 값(키 명(id, first_name...)을 d에 넣어서 field[d]로 키에 해당하는 값을 출력
        document.write("<td>" + field[d] + "</td>") ;                // field에서 첫번째 key불러오고, key에 해당하는 값 field[0]에서 찾아서 td에 넣고 , field에서 두번째 key불러오고, key에 해당하는 값 field[0]에서 찾아서 td에 넣고, ...
        }                                                            // d가 총 키값 만큼 6번 반복하고 밑에서 버튼 생성하고 다시 첫번째 for로가서 줄바꾸고 다시 내려와서 field[1]에 해당하는 값들로 td채우기 반복
        document.write("<td><button onclick='clickFnc(event)'>삭제</button></td>") ;
    }
    </script>
</body>
</html>